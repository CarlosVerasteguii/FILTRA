# Risk Profile: Story 2.3

Date: 2025-09-29
Reviewer: Quinn (Test Architect)

## Executive Summary
- Total Risks Identified: 4
- Critical Risks: 0
- High Risks: 3
- Risk Score: 65/100

## Detailed Risk Register

| ID       | Category   | Title                                                   | Prob        | Impact      | Score | Priority |
| -------- | ---------- | ------------------------------------------------------- | ----------- | ----------- | ----- | -------- |
| TECH-001 | Technical  | Frozen entity container blocks normalization updates    | Medium (2)  | High (3)    | 6     | High     |
| DATA-001 | Data       | Alias map merge corrupts canonical names                | Medium (2)  | High (3)    | 6     | High     |
| SEC-001  | Security   | Normalization logging leaks sensitive resume content    | Medium (2)  | High (3)    | 6     | High     |
| PERF-001 | Performance | Deduplication pass scales poorly on large entity sets | Medium (2)  | Medium (2)  | 4     | Medium   |

### TECH-001: Frozen entity container blocks normalization updates
- Description: ExtractedEntityCollection is a frozen dataclass; inserting normalization metadata or deduplicated entities now requires defensive cloning, risking regressions in pipeline consumers.
- Mitigation: Plan explicit builder or helper that returns a new collection with canonicalized entities plus full log, and cover with regression tests around orchestrator expectations.
- Testing Requirements: Unit tests asserting normalization log population and collection immutability semantics, plus integration tests ensuring orchestrator receives canonical entities only.
- Residual Risk: High until normalization API contract is formalized and regression tests pass.

### DATA-001: Alias map merge corrupts canonical names
- Description: Merging user-supplied alias YAML with defaults can introduce conflicting canonical keys or malformed structures that silently override defaults.
- Mitigation: Add schema validation, collision detection, and warnings before applying overrides; enforce canonical key normalization when ingesting external maps.
- Testing Requirements: Unit tests for merge/validation utilities covering duplicates, locale overrides, and malformed files; CLI integration test for failure messaging.
- Residual Risk: High unless validation prevents destructive overrides and error paths are verified.

### SEC-001: Normalization logging leaks sensitive resume content
- Description: Logging normalization summaries risks echoing raw resume snippets, conflicting with privacy constraints and PRD logging requirements.
- Mitigation: Truncate or hash sample values, constrain logs to counts and alias IDs, and run security review of logging helpers.
- Testing Requirements: Unit tests for logging formatter ensuring no raw text persists; integration test capturing logs during pipeline run.
- Residual Risk: High until log sanitization strategy is implemented and verified.

### PERF-001: Deduplication pass scales poorly on large entity sets
- Description: Pure-Python dedup plus sorting on large entity collections may add noticeable latency, especially in warm-up diagnostics.
- Mitigation: Use hashing keyed by canonical name, avoid repeated lowercasing, and benchmark against representative corpora.
- Testing Requirements: Micro-benchmarks or performance regression tests for large fixtures; ensure warm-up remains within target timings.
- Residual Risk: Medium; manageable once algorithmic complexity is confirmed.

## Risk-Based Testing Strategy
- Prioritize unit coverage for normalization helpers (TECH-001) and alias merge validation paths (DATA-001).
- Capture log outputs in tests to confirm sanitization and redact-sensitive patterns (SEC-001).
- Add integration scenario exercising CLI alias override to validate end-to-end normalization, logging, and orchestration wiring.
- Schedule performance checks on large multilingual samples before release to baseline normalization latency (PERF-001).

---

# risk_summary (paste into gate file):
risk_summary:
  totals:
    critical: 0
    high: 3
    medium: 1
    low: 0
  highest:
    id: TECH-001
    score: 6
    title: 'Frozen entity container blocks normalization updates'
  recommendations:
    must_fix:
      - TECH-001
      - DATA-001
      - SEC-001
    monitor:
      - PERF-001

Risk profile: docs/qa/assessments/2.3-risk-20250929.md
